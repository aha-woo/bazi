========================================
å…«å­—å‘½ç†è®¡ç®—ç³»ç»Ÿ - å¿«é€Ÿä½¿ç”¨æŒ‡å—
========================================

ğŸ“¦ é¡¹ç›®å·²åˆ›å»ºå®Œæˆï¼åŒ…å«ï¼š
âœ… å®Œæ•´çš„åç«¯APIæœåŠ¡ï¼ˆPython FastAPIï¼‰
âœ… å…«å­—è®¡ç®—æ ¸å¿ƒç®—æ³•
âœ… MySQLæ•°æ®åº“æ”¯æŒ
âœ… å‰ç«¯æµ‹è¯•é¡µé¢
âœ… éƒ¨ç½²è„šæœ¬å’Œæ–‡æ¡£

========================================
ä¸€ã€å¿«é€Ÿæµ‹è¯•ï¼ˆæœ¬åœ°å¼€å‘ï¼‰
========================================

ã€Windowsç”¨æˆ·ã€‘

1. å®‰è£…æ•°æ®åº“ï¼ˆMySQL æˆ– MariaDBï¼Œä»»é€‰å…¶ä¸€ï¼‰
   - MySQLä¸‹è½½ï¼šhttps://dev.mysql.com/downloads/mysql/
   - æˆ–ä½¿ç”¨å·²æœ‰çš„MariaDBæœåŠ¡ï¼ˆå®Œå…¨å…¼å®¹ï¼‰
   - åˆ›å»ºæ•°æ®åº“ï¼š
     mysql -u root -p
     # æˆ–ä½¿ç”¨ mariadb å‘½ä»¤
     CREATE DATABASE bazi_db CHARACTER SET utf8mb4;
     EXIT;

2. å¯åŠ¨åç«¯æœåŠ¡
   åŒå‡»è¿è¡Œï¼šbackend\start_dev.bat
   
   æˆ–æ‰‹åŠ¨è¿è¡Œï¼š
   cd backend
   python -m venv venv
   venv\Scripts\activate
   pip install -r requirements.txt
   python -m uvicorn app.main:app --reload

3. æ‰“å¼€å‰ç«¯æµ‹è¯•é¡µé¢
   åŒå‡»ï¼šfrontend\index.html
   
4. æµ‹è¯•API
   æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8000/docs
   åœ¨å‰ç«¯é¡µé¢è¾“å…¥å‡ºç”Ÿä¿¡æ¯ï¼Œç‚¹å‡»"å¼€å§‹è®¡ç®—"


ã€Linux/Macç”¨æˆ·ã€‘

1. å®‰è£…æ•°æ®åº“ï¼ˆMySQL æˆ–ä½¿ç”¨ç°æœ‰çš„ MariaDBï¼‰
   Ubuntu: sudo apt install mysql-server
         # æˆ–å¦‚æœå·²æœ‰ MariaDBï¼Œç›´æ¥ä½¿ç”¨å³å¯
   Mac: brew install mysql
   
   åˆ›å»ºæ•°æ®åº“ï¼š
   sudo mysql    # æˆ– sudo mariadb
   CREATE DATABASE bazi_db CHARACTER SET utf8mb4;
   EXIT;
   
   ğŸ’¡ æç¤ºï¼šå¦‚æœå·²æœ‰ MariaDB æœåŠ¡ï¼Œéƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨ï¼

2. å¯åŠ¨åç«¯æœåŠ¡
   cd backend
   chmod +x start_dev.sh
   ./start_dev.sh

3. æ‰“å¼€å‰ç«¯æµ‹è¯•é¡µé¢
   æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®æ–‡ä»¶ï¼šfrontend/index.html
   
4. æµ‹è¯•API
   è®¿é—®ï¼šhttp://localhost:8000/docs

========================================
äºŒã€APIè°ƒç”¨ç¤ºä¾‹
========================================

ã€æ¥å£åœ°å€ã€‘
POST http://localhost:8000/api/v1/bazi/calculate

ã€è¯·æ±‚ç¤ºä¾‹ã€‘
{
  "year": 1990,
  "month": 5,
  "day": 15,
  "hour": 14,
  "minute": 30,
  "timezone": "Asia/Shanghai",
  "user_id": "test001"
}

ã€ä½¿ç”¨curlæµ‹è¯•ã€‘
curl -X POST "http://localhost:8000/api/v1/bazi/calculate" \
  -H "Content-Type: application/json" \
  -d '{
    "year": 1990,
    "month": 5,
    "day": 15,
    "hour": 14,
    "minute": 30,
    "timezone": "Asia/Shanghai"
  }'

ã€JavaScriptè°ƒç”¨ã€‘
fetch('http://localhost:8000/api/v1/bazi/calculate', {
  method: 'POST',
  headers: {'Content-Type': 'application/json'},
  body: JSON.stringify({
    year: 1990,
    month: 5,
    day: 15,
    hour: 14,
    minute: 30,
    timezone: 'Asia/Shanghai'
  })
})
.then(res => res.json())
.then(data => console.log(data));

========================================
ä¸‰ã€éƒ¨ç½²åˆ°Ubuntu VPS
========================================

ã€æ–¹æ³•ä¸€ï¼šè‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èï¼‰ã€‘

1. ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨
   scp -r backend user@your-server-ip:/home/user/bazi-api

2. SSHç™»å½•æœåŠ¡å™¨
   ssh user@your-server-ip

3. è¿è¡Œéƒ¨ç½²è„šæœ¬
   cd /home/user/bazi-api/backend
   chmod +x deploy.sh
   ./deploy.sh
   
   è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
   - âœ… æ£€æµ‹ç°æœ‰çš„ MariaDB/MySQL æœåŠ¡
   - âœ… è¯¢é—®æ˜¯å¦ä½¿ç”¨ç°æœ‰æ•°æ®åº“ï¼ˆå¦‚æœ‰ MariaDB é€‰æ‹© yï¼‰
   - âœ… æ”¯æŒè‡ªå®šä¹‰æ•°æ®åº“ä¸»æœºå’Œç«¯å£
   - âœ… è‡ªåŠ¨åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·
   - âœ… å®Œæˆæ‰€æœ‰é…ç½®

4. è®¿é—®API
   http://your-server-ip:8000
   http://your-server-ip:8000/docs

ğŸ’¡ MariaDB ç”¨æˆ·ï¼šè„šæœ¬ä¼šè‡ªåŠ¨è¯†åˆ«å¹¶ä½¿ç”¨æ‚¨çš„ MariaDBï¼


ã€æ–¹æ³•äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²ã€‘

è¯¦ç»†æ­¥éª¤è¯·æŸ¥çœ‹ï¼šbackend/README.md

åŒ…æ‹¬ï¼š
- ç³»ç»Ÿä¾èµ–å®‰è£…
- MySQLé…ç½®
- è™šæ‹Ÿç¯å¢ƒåˆ›å»º
- systemdæœåŠ¡é…ç½®
- Nginxåå‘ä»£ç†
- SSLè¯ä¹¦é…ç½®


ã€æœåŠ¡ç®¡ç†å‘½ä»¤ã€‘

å¯åŠ¨æœåŠ¡ï¼š  sudo systemctl start bazi-api
åœæ­¢æœåŠ¡ï¼š  sudo systemctl stop bazi-api
é‡å¯æœåŠ¡ï¼š  sudo systemctl restart bazi-api
æŸ¥çœ‹çŠ¶æ€ï¼š  sudo systemctl status bazi-api
æŸ¥çœ‹æ—¥å¿—ï¼š  sudo journalctl -u bazi-api -f


ã€é…ç½®Nginxï¼ˆå¯é€‰ï¼‰ã€‘

å¦‚éœ€é€šè¿‡åŸŸåè®¿é—®æˆ–é…ç½®HTTPSï¼š

sudo nano /etc/nginx/sites-available/bazi-api

æ·»åŠ é…ç½®ï¼š
server {
    listen 80;
    server_name yourdomain.com;
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
    }
}

å¯ç”¨é…ç½®ï¼š
sudo ln -s /etc/nginx/sites-available/bazi-api /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx

========================================
å››ã€å®¢æˆ·ç«¯é›†æˆ
========================================

ã€Webå‰ç«¯ã€‘
ç›´æ¥ä½¿ç”¨fetchæˆ–axiosè°ƒç”¨API

ã€iOSåº”ç”¨ã€‘
ä½¿ç”¨URLSessionæˆ–Alamofire

ã€Androidåº”ç”¨ã€‘
ä½¿ç”¨Retrofitæˆ–OkHttp

ã€å¾®ä¿¡å°ç¨‹åºã€‘
ä½¿ç”¨wx.request()

ã€Flutterã€‘
ä½¿ç”¨httpåŒ…æˆ–dio

è¯¦ç»†ç¤ºä¾‹ä»£ç è¯·æŸ¥çœ‹ï¼šREADME.md å’Œ backend/README.md

========================================
äº”ã€é‡è¦æ–‡ä»¶è¯´æ˜
========================================

backend/
  â”œâ”€â”€ app/main.py              # FastAPIä¸»åº”ç”¨å…¥å£
  â”œâ”€â”€ app/bazi_calculator.py   # å…«å­—è®¡ç®—æ ¸å¿ƒç®—æ³•
  â”œâ”€â”€ requirements.txt         # Pythonä¾èµ–åŒ…
  â”œâ”€â”€ env.example             # ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹
  â”œâ”€â”€ deploy.sh               # Ubuntuè‡ªåŠ¨éƒ¨ç½²è„šæœ¬
  â”œâ”€â”€ start_dev.sh            # Linuxå¼€å‘å¯åŠ¨è„šæœ¬
  â”œâ”€â”€ start_dev.bat           # Windowså¼€å‘å¯åŠ¨è„šæœ¬
  â””â”€â”€ README.md               # åç«¯è¯¦ç»†æ–‡æ¡£

frontend/
  â”œâ”€â”€ index.html              # æµ‹è¯•é¡µé¢
  â”œâ”€â”€ app.js                  # å‰ç«¯é€»è¾‘
  â””â”€â”€ README.md               # å‰ç«¯ä½¿ç”¨è¯´æ˜

README.md                     # é¡¹ç›®æ€»æ–‡æ¡£
ä½¿ç”¨è¯´æ˜.txt                  # æœ¬æ–‡ä»¶

========================================
å…­ã€é…ç½®æ•°æ®åº“è¿æ¥
========================================

1. å¤åˆ¶é…ç½®æ–‡ä»¶
   cd backend
   cp env.example .env

2. ç¼–è¾‘.envæ–‡ä»¶
   Windows: notepad .env
   Linux/Mac: nano .env

3. ä¿®æ”¹æ•°æ®åº“è¿æ¥ï¼ˆé‡è¦ï¼ï¼‰
   DATABASE_URL=mysql+pymysql://ç”¨æˆ·å:å¯†ç @localhost:3306/bazi_db
   
   ç¤ºä¾‹ï¼š
   DATABASE_URL=mysql+pymysql://root:123456@localhost:3306/bazi_db

========================================
ä¸ƒã€APIæ¥å£åˆ—è¡¨
========================================

ã€æ ¸å¿ƒæ¥å£ã€‘
POST   /api/v1/bazi/calculate          # è®¡ç®—å…«å­—
GET    /api/v1/bazi/record/{id}        # æŸ¥è¯¢è®°å½•
GET    /api/v1/bazi/user/{user_id}     # æŸ¥è¯¢ç”¨æˆ·è®°å½•
GET    /api/v1/bazi/records            # æŸ¥è¯¢æ‰€æœ‰è®°å½•
DELETE /api/v1/bazi/record/{id}        # åˆ é™¤è®°å½•

ã€å·¥å…·æ¥å£ã€‘
GET    /api/v1/timezones               # è·å–æ—¶åŒºåˆ—è¡¨
GET    /health                         # å¥åº·æ£€æŸ¥
GET    /                               # APIä¿¡æ¯
GET    /docs                           # Swaggeræ–‡æ¡£
GET    /redoc                          # ReDocæ–‡æ¡£

========================================
å…«ã€æµ‹è¯•æ£€æŸ¥æ¸…å•
========================================

æœ¬åœ°æµ‹è¯•ï¼š
â–¡ åç«¯æœåŠ¡å¯åŠ¨æˆåŠŸï¼ˆhttp://localhost:8000ï¼‰
â–¡ æ•°æ®åº“è¿æ¥æ­£å¸¸ï¼ˆæ— é”™è¯¯æ—¥å¿—ï¼‰
â–¡ APIæ–‡æ¡£å¯è®¿é—®ï¼ˆhttp://localhost:8000/docsï¼‰
â–¡ å‰ç«¯é¡µé¢å¯æ‰“å¼€
â–¡ æäº¤æµ‹è¯•æ•°æ®è¿”å›æ­£ç¡®ç»“æœ
â–¡ å››æŸ±è®¡ç®—æ­£ç¡®ï¼ˆå¹´æœˆæ—¥æ—¶ï¼‰
â–¡ äº”è¡Œåˆ†ææ­£ç¡®
â–¡ å‘½ç†è§£è¯»æ˜¾ç¤ºæ­£å¸¸

VPSéƒ¨ç½²ï¼š
â–¡ æœåŠ¡è‡ªåŠ¨å¯åŠ¨ï¼ˆsystemctl status bazi-apiï¼‰
â–¡ å¤–ç½‘å¯è®¿é—®ï¼ˆhttp://your-ip:8000ï¼‰
â–¡ é˜²ç«å¢™ç«¯å£å¼€æ”¾ï¼ˆ8000ï¼‰
â–¡ Nginxé…ç½®æ­£ç¡®ï¼ˆå¯é€‰ï¼‰
â–¡ SSLè¯ä¹¦é…ç½®ï¼ˆå¯é€‰ï¼‰

========================================
ä¹ã€å¸¸è§é—®é¢˜
========================================

Q1: åç«¯å¯åŠ¨å¤±è´¥ï¼Œæç¤º"Can't connect to database"
A1: æ£€æŸ¥MySQLæ˜¯å¦è¿è¡Œï¼Œæ•°æ®åº“æ˜¯å¦åˆ›å»ºï¼Œ.envé…ç½®æ˜¯å¦æ­£ç¡®

Q2: å‰ç«¯æç¤º"æ— æ³•è¿æ¥åˆ°API"
A2: ç¡®ä¿åç«¯æœåŠ¡å·²å¯åŠ¨ï¼Œæ£€æŸ¥APIåœ°å€æ˜¯å¦æ­£ç¡®

Q3: è·¨åŸŸé”™è¯¯ï¼ˆCORS errorï¼‰
A3: åç«¯å·²é…ç½®CORSï¼Œå¦‚ä»æœ‰é—®é¢˜ï¼Œä½¿ç”¨http-serverè¿è¡Œå‰ç«¯

Q4: å…«å­—è®¡ç®—ç»“æœä¸å…¶ä»–å·¥å…·ä¸åŒ
A4: ä¸åŒå·¥å…·ç®—æ³•å¯èƒ½æœ‰å·®å¼‚ï¼Œæ³¨æ„æ—¶åŒºè®¾ç½®

Q5: VPSéƒ¨ç½²åå¤–ç½‘æ— æ³•è®¿é—®
A5: æ£€æŸ¥é˜²ç«å¢™ï¼ˆsudo ufw allow 8000ï¼‰ï¼Œæ£€æŸ¥äº‘æœåŠ¡å•†å®‰å…¨ç»„

========================================
åã€æŠ€æœ¯æ”¯æŒ
========================================

ã€æ–‡æ¡£ã€‘
- é¡¹ç›®æ€»è§ˆï¼šREADME.md
- åç«¯æ–‡æ¡£ï¼šbackend/README.md
- å‰ç«¯æ–‡æ¡£ï¼šfrontend/README.md
- APIæ–‡æ¡£ï¼šhttp://localhost:8000/docs

ã€æµ‹è¯•å·¥å…·ã€‘
- Swagger UIï¼šhttp://localhost:8000/docs
- ReDocï¼šhttp://localhost:8000/redoc
- Postmanï¼šå¯¼å…¥APIè¿›è¡Œæµ‹è¯•

ã€æ—¥å¿—æŸ¥çœ‹ã€‘
- å¼€å‘ç¯å¢ƒï¼šç›´æ¥åœ¨ç»ˆç«¯æŸ¥çœ‹è¾“å‡º
- ç”Ÿäº§ç¯å¢ƒï¼šsudo journalctl -u bazi-api -f

========================================
åä¸€ã€ä¸‹ä¸€æ­¥å¼€å‘å»ºè®®
========================================

ã€åŠŸèƒ½æ‰©å±•ã€‘
- å¤§è¿æ¨ç®—
- æµå¹´åˆ†æ
- åˆå©šé…å¯¹
- æ‹©æ—¥åŠŸèƒ½

ã€ç³»ç»Ÿä¼˜åŒ–ã€‘
- æ·»åŠ ç”¨æˆ·è®¤è¯ï¼ˆJWTï¼‰
- æ·»åŠ Redisç¼“å­˜
- APIè®¿é—®é¢‘ç‡é™åˆ¶
- æ›´ç²¾ç¡®çš„èŠ‚æ°”è®¡ç®—

ã€å‰ç«¯å¼€å‘ã€‘
- ä½¿ç”¨React/Vue/Angularé‡æ„
- å¼€å‘ç§»åŠ¨APPï¼ˆReact Native/Flutterï¼‰
- å¼€å‘å°ç¨‹åºç‰ˆæœ¬

ã€è¿ç»´ç›‘æ§ã€‘
- é…ç½®Prometheusç›‘æ§
- é…ç½®æ—¥å¿—åˆ†æ
- è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼ˆCI/CDï¼‰

========================================

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£ï¼š
- README.md
- backend/README.md  
- frontend/README.md

æˆ–åœ¨çº¿è®¿é—®APIæ–‡æ¡£ï¼šhttp://localhost:8000/docs

========================================

